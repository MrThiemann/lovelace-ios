type: vertical-stack
cards:
  - type: vertical-stack
    cards:
      - name: Flur OG
        template:
          - header
        type: custom:button-card
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            entity: light.flur_og
            icon: hue:double-spot
            name: Decke Flur OG
            template:
              - kt_card_2
              - light
              - bright
              - cl
          - type: custom:button-card
            entity: light.ty64038772f4cfa251f8c2
            icon: hue:single-spot
            name: Decke Flur
            template:
              - kt_card_2
              - light
              - bright
              - cl
          - type: custom:button-card
            entity: light.ty64038772f4cfa251f4eb
            icon: hue:single-spot
            name: Decke Flur
            template:
              - kt_card_2
              - light
              - bright
              - cl
          - type: custom:button-card
            color_type: blank-card
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            entity: light.tybfa23d68fa30fff8f60geg
            icon: hue:wall-appear
            name: Wandlampe Treppe
            template:
              - kt_card_2
              - light
              - bright
              - cl
            custom_fields:
              bm:
                card:
                  entity: binary_sensor.presence_12
                  styles:
                    card:
                      - background-color: '#242e42'
                      - height: 25px
                      - width: 25px
                    icon: null
                  layout: vertical
                  name: []
                  state:
                    - value: 'on'
                      styles:
                        state:
                          - color: green
                        card:
                          - filter: drop-shadow(0 0 1.0rem rgb(243,156,15))
                          - border: 0px
                        icon:
                          - color: rgb(255,0,0)
                          - width: 15px;
                    - value: 'off'
                      styles:
                        name: null
                        icon:
                          - color: green
                          - icon: mdi:security
                          - width: 15px;
                  type: custom:button-card
          - type: custom:button-card
            entity: light.wlan_weihnachtslicht_rgb
            icon: mdi:string-lights
            name: Lichterkette Treppe
            show_icon: true
            aspect_ratio: 1/1
            hold_action:
              action: more-info
            tap_action:
              action: toggle
            show_state: true
            template:
              - kt_card_2
              - popup_light_rgb
            custom_fields:
              bright: |
                [[[
                  function capitalizeFirstLetter(string) {
                    return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();
                  }
                  
                  const length = 41;
                  const width = 3;

                  if (entity.state === 'on' && entity.attributes.brightness) {
                    const radius = length / 2;
                    const brightness = Math.round(entity.attributes.brightness / 2.54);
                    const circumference = radius * 2 * Math.PI;
                    return `
                      <svg viewBox="0 0 50 50">
                        <circle style="
                            transform: rotate(-90deg);
                            transform-origin: 50% 50%;
                            stroke-dasharray: ${circumference};
                            stroke-dashoffset: ${circumference - brightness / 100 * circumference};
                          "
                          id="c_brightness" cx="25" cy="25" r="${radius}" stroke="var(--paper-item-icon-active-color)" stroke-width="${width}" fill="none" stroke-linecap="round" />
                        <text x="50%" y="54%" fill="var(--primary-text-color)" font-size="14" text-anchor="middle" alignment-baseline="middle">${brightness}<tspan font-size="10">%</tspan>
                        </text>
                      </svg>
                      `;
                    }
                  else if (entity.state === 'on' && entity.attributes.speed && entity.attributes.speed_list)  {
                    const text = capitalizeFirstLetter(entity.attributes.speed);
                    const gap = 5;
                    const edge = (50 - length) / 2;
                    const y = 50 - edge;
                    var items = entity.attributes.speed_list;
                    if (items.indexOf('off') !== -1){
                      items.splice(items.indexOf('off'), 1);
                    }
                    const current = items.indexOf(entity.attributes.speed)
                    var i;
                    var x1 = edge;
                    var ret = `<svg  viewBox="0 0 50 50">`;
                    var l = (length - gap * (items.length - 1)) / items.length;
                    for (i = 0; i < items.length; i++) {
                      var x2 = x1 + l;
                      var color = (i <= current) ? "var(--paper-item-icon-active-color)" : "var(--paper-item-icon-color)";
                      var opacity = (i <= current) ? "1.0" : "0.5";
                      ret += `<line x1="${x1}" y1="${y}" x2="${x2}" y2="${y}" stroke="${color}" stroke-width="${width}" opacity="${opacity}" stroke-linecap="round" />`;
                      x1 = x2 + gap;
                    }
                    ret += `<text x="50%" y="54%" fill="var(--primary-text-color)" font-size="14" text-anchor="middle" alignment-baseline="middle">${text}</text></svg>`
                    return ret;
                  }
                ]]]
              cl:
                card:
                  type: custom:button-card
                  icon: mdi:palette
                  name: false
                  entity_picture: /local/multic.png
                  show_entity_picture: true
                  show_name: false
                  styles:
                    card:
                      - background-color: '#242e42'
                      - height: 25px
                      - width: 25px
                    icon:
                      - width: 15px
          - type: custom:button-card
            color_type: blank-card
          - type: custom:button-card
            color_type: blank-card
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            color_type: blank-card
          - type: custom:button-card
            color_type: blank-card
          - type: custom:button-card
            color_type: blank-card
  - type: vertical-stack
    cards:
      - type: custom:button-card
        color_type: blank-card
  - type: vertical-stack
    cards:
      - type: vertical-stack
        cards:
          - name: Bad & WC OG
            template:
              - header
            type: custom:button-card
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: light.wc_eg
                icon: hue:room-toilet
                name: WC
                show_icon: true
                aspect_ratio: 1/1
                show_state: true
                template:
                  - kt_card_2
                  - popup_light_rgb
                custom_fields:
                  bright: |
                    [[[
                      function capitalizeFirstLetter(string) {
                        return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();
                      }
                      
                      const length = 41;
                      const width = 3;

                      if (entity.state === 'on' && entity.attributes.brightness) {
                        const radius = length / 2;
                        const brightness = Math.round(entity.attributes.brightness / 2.54);
                        const circumference = radius * 2 * Math.PI;
                        return `
                          <svg viewBox="0 0 50 50">
                            <circle style="
                                transform: rotate(-90deg);
                                transform-origin: 50% 50%;
                                stroke-dasharray: ${circumference};
                                stroke-dashoffset: ${circumference - brightness / 100 * circumference};
                              "
                              id="c_brightness" cx="25" cy="25" r="${radius}" stroke="var(--paper-item-icon-active-color)" stroke-width="${width}" fill="none" stroke-linecap="round" />
                            <text x="50%" y="54%" fill="var(--primary-text-color)" font-size="14" text-anchor="middle" alignment-baseline="middle">${brightness}<tspan font-size="10">%</tspan>
                            </text>
                          </svg>
                          `;
                        }
                      else if (entity.state === 'on' && entity.attributes.speed && entity.attributes.speed_list)  {
                        const text = capitalizeFirstLetter(entity.attributes.speed);
                        const gap = 5;
                        const edge = (50 - length) / 2;
                        const y = 50 - edge;
                        var items = entity.attributes.speed_list;
                        if (items.indexOf('off') !== -1){
                          items.splice(items.indexOf('off'), 1);
                        }
                        const current = items.indexOf(entity.attributes.speed)
                        var i;
                        var x1 = edge;
                        var ret = `<svg  viewBox="0 0 50 50">`;
                        var l = (length - gap * (items.length - 1)) / items.length;
                        for (i = 0; i < items.length; i++) {
                          var x2 = x1 + l;
                          var color = (i <= current) ? "var(--paper-item-icon-active-color)" : "var(--paper-item-icon-color)";
                          var opacity = (i <= current) ? "1.0" : "0.5";
                          ret += `<line x1="${x1}" y1="${y}" x2="${x2}" y2="${y}" stroke="${color}" stroke-width="${width}" opacity="${opacity}" stroke-linecap="round" />`;
                          x1 = x2 + gap;
                        }
                        ret += `<text x="50%" y="54%" fill="var(--primary-text-color)" font-size="14" text-anchor="middle" alignment-baseline="middle">${text}</text></svg>`
                        return ret;
                      }
                    ]]]
                  cl:
                    card:
                      type: custom:button-card
                      icon: mdi:palette
                      name: false
                      entity_picture: /local/multic.png
                      show_entity_picture: true
                      show_name: false
                      styles:
                        card:
                          - background-color: '#242e42'
                          - height: 25px
                          - width: 25px
                        icon:
                          - width: 15px
                  bm:
                    card:
                      entity: binary_sensor.presence_12
                      styles:
                        card:
                          - background-color: '#242e42'
                          - height: 25px
                          - width: 25px
                          - margin-bottom: 100%
                        icon:
                          - width: 15px
                      layout: vertical
                      name: []
                      state:
                        - value: 'on'
                          styles:
                            state:
                              - color: green
                            card:
                              - filter: drop-shadow(0 0 1.0rem rgb(243,156,15))
                              - border: 0px
                            icon:
                              - color: rgb(255,0,0)
                        - value: 'off'
                          styles:
                            name: null
                            icon:
                              - color: green
                              - icon: mdi:security
                      type: custom:button-card
              - type: custom:button-card
                entity: light.ty84621220c82b9655253b
                icon: hue:single-spot
                name: Decke
                template:
                  - kt_card_2
                  - light
                  - bright
                  - cl
              - type: custom:button-card
                color_type: blank-card
              - type: custom:button-card
                color_type: blank-card
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: light.lsc_light_strip_rgbcw_wifi_3
                icon: phu:light-strip
                name: Bad
                template:
                  - kt_card_2
                  - light
                  - bright
                  - cl
                custom_fields:
                  bm:
                    card:
                      entity: binary_sensor.presence_18
                      styles:
                        card:
                          - background-color: '#242e42'
                          - height: 25px
                          - width: 25px
                        icon: null
                      layout: vertical
                      name: []
                      state:
                        - value: 'on'
                          styles:
                            state:
                              - color: green
                            card:
                              - filter: drop-shadow(0 0 1.0rem rgb(243,156,15))
                              - border: 0px
                            icon:
                              - color: rgb(255,0,0)
                              - width: 15px;
                        - value: 'off'
                          styles:
                            name: null
                            icon:
                              - color: green
                              - icon: mdi:security
                              - width: 15px;
                      type: custom:button-card
              - type: custom:button-card
                entity: light.ty84621220c82b9655253b
                icon: hue:double-spot
                name: Decke
                template:
                  - kt_card_2
                  - light
                  - bright
                  - cl
              - type: custom:button-card
                color_type: blank-card
              - type: custom:button-card
                color_type: blank-card
      - type: vertical-stack
        cards:
          - type: vertical-stack
            cards: []
  - type: vertical-stack
    cards: []
  - type: vertical-stack
    cards:
      - type: vertical-stack
        cards:
          - name: Schlafzimmer
            template:
              - header
            type: custom:button-card
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: light.schlafzimmer
                icon: phu:pendant-round
                name: Decke
                template:
                  - kt_card_2
                  - light
                  - bright
                  - cl
              - type: custom:button-card
                entity: light.kuechensockel
                icon: phu:light-strip
                name: RGB Stripes
                template:
                  - kt_card_2
                  - light
                  - bright
                  - cl
              - type: custom:button-card
                color_type: blank-card
              - type: custom:button-card
                color_type: blank-card
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                entity: switch.tp_link_01
                icon: phu:desk-lamp
                name: Karsten
                template:
                  - kt_card_2
                  - light
                  - bright
                  - cl
              - type: custom:button-card
                color_type: blank-card
              - type: custom:button-card
                entity: switch.tp_link_01
                icon: phu:desk-lamp
                name: Nathallie
                template:
                  - kt_card_2
                  - light
                  - bright
                  - cl
              - type: custom:button-card
                color_type: blank-card
          - type: horizontal-stack
            cards:
              - type: custom:button-card
                color_type: blank-card
              - type: custom:button-card
                color_type: blank-card
              - type: custom:button-card
                color_type: blank-card
      - type: vertical-stack
        cards:
          - type: custom:button-card
            color_type: blank-card
